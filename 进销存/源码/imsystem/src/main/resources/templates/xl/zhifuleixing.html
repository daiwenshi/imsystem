<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
	<head>
	<title>Notifications</title>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
	<!-- VENDOR CSS -->
	<link rel="stylesheet" th:href="@{/assets/css/bootstrap.min.css}">
	<link rel="stylesheet" th:href="@{/assets/css/font-awesome.min.css}">
	<link rel="stylesheet" th:href="@{/assets/css/style.css}">
	<link rel="stylesheet" th:href="@{/assets/css/toastr.min.css}">
	<!-- MAIN CSS -->
	<link rel="stylesheet" th:href="@{/assets/css/main.css}">
	<!-- FOR DEMO PURPOSES ONLY. You should remove this in your project -->
	<link rel="stylesheet" th:href="@{/assets/css/demo.css}">
	<link rel="stylesheet" th:href="@{/assets/css/myStyle.css}">
	<!-- GOOGLE FONTS -->
	
	<!-- ICONS -->
	<link rel="apple-touch-icon" sizes="76x76" th:href="@{/assets/img/apple-icon.png}">
	<link rel="icon" type="image/png" sizes="96x96" th:href="@{/assets/img/favicon.png}">
	<style type="text/css">
		
		
		.table{
				color: rgb(2, 143, 208);
			
				text-align: center;
				
			}
		.table>tbody>tr>td, .table>tbody>tr>th, .table>tfoot>tr>td, .table>tr>th, .table>thead>tr>td, .table>tr>th{
				border-top: 1px solid rgb(2, 143, 208);
				color: #686B6E;
				
			}
		
		th{
			text-align: center;
			border-bottom:2px solid rgb(2,143,208);
			color:#686B6E;
		}
		.ta{
			padding: 0px 20px;
			}
		.table-striped>tbody>tr:nth-of-type(odd){
				background-color: transparent;
			}
		
		.an{
			color: rgb(2, 143, 208);
			
		} 
		
		

		#page {
			width: 100%;
			margin: 20px auto;
		}
		
		
		
		.table>thead>tr>th{
			border-bottom:2px solid rgb(2,143,208);
			color: #686B6E;
			
		}
		
		/* .pagebtn{
			background-color:rgb(2,143,208) ;
		} */
	</style>
	</head>
	<body>
	
		<div class="main">
			<!-- MAIN CONTENT -->
			<div class="main-content">
				<div class="container-fluid">
					<div class="panel panel-headline">
						<div class="panel-heading">
							<h3 class="panel-title ptitle">支付类型</h3>
						</div>
						<div class="ta">
						 <input class="col-md-2 col-md-offset-7 tiaojian" type="text" placeholder="请输入搜索条件" /><input class="col-md-1 btn btn-primary btn-lg" type="button" value="GO" style="height: 27px;line-height: 5px;margin-bottom: 5px; background-color: rgb(2, 143, 208);" @click="query()" />
						<button type="button" value="新增" class="btn btn-primary btn-lg col-md-1" data-toggle="modal" data-target="#myModal" style="height: 30px;line-height: 5px; margin-bottom: 5px; margin-left: 40px;background-color: rgb(2, 143, 208);" >
	  						新增
						</button>
						<table class="table table-striped">
							<thead>
								<tr>
									<th>类型名称</th>
									<th>创建时间</th>
									<th>最后修改时间</th>
									<th>操作人</th>
									<th>操作</th>
								</tr>
							</thead>
							<tbody>
							<tr v-for="(temp,index) in pageIf.list">
							 	
								<td v-text="temp.name"></td>
								<td v-text="formatDate(temp.time)"></td>
								<td v-text="formatDate(temp.updatetime)"></td> 
								<td v-text="temp.uname"></td>
								
								<td style="padding-left: 40px; padding-right: 30px" >
									<span class="glyphicon glyphicon-edit an open" id="open"  @click="open(temp.id)"></span>
									<a :href="dele(temp.id)"><span class="glyphicon glyphicon-trash an"></span></a>
									
								</td> 
							</tr>
							</tbody>
							<!--<tr>
								<td>张三</td>
								<td>李四</td>
								<td>0.8</td>
								<td>003号</td>
								<td>正常</td>
								<td>2019-03-12</td>
								<td>2019-03-16</td>
								<td>Z004</td>
								<td>
									<button type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#myModal1" style="height: 30px;line-height: 5px;">
			  						修改
									</button>
								</td>
							</tr>-->
						</table>
							<div id="page">
							</div> 
						</div>
						<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">		
								<div class="modal-dialog" role="document">
		    						<div class="modal-content">
		      							<div class="modal-header">
									        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
									        <h4 class="modal-title" id="myModalLabel">新增支付类型</h4>
		      							</div>
								      <div class="modal-body">
								      
								      
								        	
										<form class="form-horizontal">
											
										
										  	<div class="form-group">
										    	<label for="InSname" class="col-sm-3 control-label">类型名称</label>
											    <div class="col-sm-9">
											    	<input type="text" class="form-control" id="ssname">
											    </div>
										  	</div>
										  	
										  	<div class="form-group">
										    	<label for="inputEmail3" class="col-sm-3 control-label">操作人</label>
											    <div class="col-sm-9">
											    	<input type="text" class="form-control" id="ssuid" :value="us.name" >
											    </div>
										  	</div>
										  	
										  	
										  
										</form>
										
								      </div>
								      <div class="modal-footer">
								        <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
								        <button type="button" class="btn btn-primary" id="tijiao" style="background-color:rgb(2,143,208);">提交</button>
								      </div>
								      
		    						</div>
		  						</div>
		  				</div>
		  					
		  				<div class="modal fade" id="myModal1" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">		
								<div class="modal-dialog" role="document">
		    						<div class="modal-content">
		      							<div class="modal-header">
									        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
									        <h4 class="modal-title" id="myModalLabel">修改支付类型</h4>
		      							</div>
								      	<div class="modal-body">
								      		<form class="form-horizontal">
								      		
								      		<div class="form-group">
										    	<label for="inputEmail3" class="col-sm-3 control-label">类型ID</label>
											    <div class="col-sm-9">
											    	<input type="text" class="form-control" id="sid">
											    </div>
										  	</div>
								      		
										  	<div class="form-group">
										    	<label for="inputEmail3" class="col-sm-3 control-label">类型名称</label>
											    <div class="col-sm-9">
											    	<input type="text" class="form-control" id="sname">
											    </div>
										  	</div>
										  	<div class="form-group">
										    	<label for="inputPassword3" class="col-sm-3 control-label">创建时间</label>
											    <div class="col-sm-9">
											      <input type="text" class="form-control" id="stime">
											    </div>
										  	</div>
										  
										  	<div class="form-group">
										    	<label for="inputEmail3" class="col-sm-3 control-label">操作人</label>
											    <div class="col-sm-9">
											    	<input type="text" class="form-control" id="suid" :value="us.name">
											    </div>
										  	</div>
										  	
										  	
										  
										</form>
								        
								      	</div>
								      <div class="modal-footer">
								        <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
								        <button type="button" class="btn btn-primary xiugai" style="background-color:rgb(2,143,208);">修改</button>
								      </div>
		    						</div>
		  						</div>
		  				</div>
						
							
					</div>
				</div>
			</div>
		</div>
		
		
	<script th:src="@{/assets/js/jquery.min.js}"></script>
	<script th:src="@{/assets/js/bootstrap.min.js}"></script>
	<script th:src="@{/assets/js/jquery.slimscroll.min.js}"></script>
	<script th:src="@{/assets/js/toastr.min.js}"></script>
	<script th:src="@{/assets/js/klorofil-common.js}"></script>	
	
	<script th:src="@{/assets/js/pageNumber.js}"></script>
	<script type="text/javascript" th:src="@{/assets/js/bootstrap-datetimepicker.js}"></script>
	<script type="text/javascript" th:src="@{/assets/js/vue.js}"></script>
	<script type="text/javascript"  th:inline="javascript" >
	var vue = new Vue({
		el : ".main",
		data : {
			pageIf : {},
			us : {}
			
		},
		methods : {

		 query:function(currentpage){
				var tiaojian=$(".tiaojian").val();
				
				$.ajax({
					url : "/paytype/querypage",
					data : {
						tiaojian:tiaojian,
						currentPage : currentpage
					},
					type : "post",
					dataType : "json",
					success:function(result){
						vue.pageIf = result;
						$("#page").append(page(vue.pageIf.pageNum,vue.pageIf.prePage,vue.pageIf.nextPage,vue.pageIf.pages));
					}
				});
			},
			dele:function(id){
				return "/paytype/delete?id="+id;
			},
			open:function(id){
				$('#myModal1').modal('toggle')
				
				$.ajax({
					url:"/paytype/byid",
					data:{
						id:id
						},
					type:"post",
					dataType:"json",
					success:function(data){
	                            //赋值
	                            $('#sid').val(data.id);
	                            $('#sname').val(data.name);
	                            $('#stime').val(vue.formatDate(data.time));
	                            
	                            
	                            
	                            $('#sid').attr("readonly","readonly");
	                            $('#stime').attr("readonly","readonly");
	                            $('#suid').attr("readonly","readonly");
					}
				});
				
			},
			
			formatDate: function (value) {
		        let date = new Date(value);
		        let y = date.getFullYear();
		        let MM = date.getMonth() + 1;
		        MM = MM < 10 ? ('0' + MM) : MM;
		        let d = date.getDate();
		        d = d < 10 ? ('0' + d) : d;
		        let h = date.getHours();
		        h = h < 10 ? ('0' + h) : h;
		        let m = date.getMinutes();
		        m = m < 10 ? ('0' + m) : m;
		        let s = date.getSeconds();
		        s = s < 10 ? ('0' + s) : s;
		        return y + '-' + MM + '-' + d + ' ' + h + ':' + m + ':' + s;
		      }
			
			
		},
		created:function(){
			this.query();
		}
	});
	
	
	$(function(){
		
		$(document).on("click",".pageFy>ul li",function(){
			 var create = $(this).attr("pageNumber");
			 if(create != null && create != 0){
				 vue.query(create);
			 }
		 });
		vue.us = JSON.parse(window.localStorage.getItem("user"));
		 $("#tijiao").click(function(){
				
				var name=$("#ssname").val();
				var uid = vue.us.id;
				
				
				$.ajax({
					url:"/paytype/insert",
					data:{
						name:name,
						uid:uid
					},
					type:"post",
					dataType:"json",
					success:function(result){
						if(result==0){
							alert("此规格已存在，请重新添加")
						}
						location.href ="/paytype/querypaytype";
					}
				});
		}); 
		 
		 $(".xiugai").click(function(){
			 var id=$("#sid").val();
			 var name=$("#sname").val();
			 var uid = vue.us.id;
			 $.ajax({
				 url:"/paytype/toupdate",
				 data:{
					 id:id,
					 name:name,
					 uid:uid
					
				 },
				 type:"post",
				 dataType:"json",
				 success:function(result){
					 if(result==0){
						 alert("你修改的支付类型已存在");
					 }
					 location.href="/paytype/querypaytype";
				 }
			 });
		 })
		 
		 
	 });
	
	
	
	</script>
</body>
</html>
