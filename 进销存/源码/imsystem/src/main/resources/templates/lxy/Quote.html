
<!DOCTYPE html>
<html>
	<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- Tell the browser to be responsive to screen width -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <!-- Favicon icon -->
    <title>客户报价页面</title>
    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" th:href="@{/assets/vendor/font-awesome/css/font-awesome.min.css}">
    <link rel="apple-touch-icon" sizes="76x76" th:href="@{/assets/img/apple-icon.png}">
	<link rel="icon" type="image/png" sizes="96x96" th:href="@{/assets/img/favicon.png}">
	
	<link rel="stylesheet" th:href="@{/assets/css/bootstrap.min.css}"> 
	
    <link th:href="@{/assets/XiTong/css/bootstrap.min.css}" rel="stylesheet">
    <!-- Custom CSS -->
    <link th:href="@{/assets/XiTong/css/style.css}" rel="stylesheet">
    <!-- You can change the theme colors from here -->
    <link th:href="@{/assets/XiTong/css/blue.css}" id="theme" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/assets/css/myStyle.css}">
    
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script th:src="@{https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js}"></script>
    <script th:src="@{https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js}"></script>
<![endif]-->
<style type="text/css">
	*{
		-webkit-user-select: none;
	}
	[type="checkbox"]:not(:checked), [type="checkbox"]:checked{
		position: relative;
    	left: 0px;
    	opacity: 10;
	}
	h5 label{
		padding-top: 6px;
		margin-bottom: 0px;
		margin-right: 8px;
	}
	.btn-primary, .btn-primary.disabled{
		border-color: #00a0f0;
		background-color: rgb(2, 143, 208);
	}
	#searchZero{
		display: flex;
		flex: row;
		margin-right: 6%;
	}
	.table{
		font-size: 1.8rem;
	}
	.table>thead>tr>th{
		border-bottom: 2px solid rgb(2, 143, 208);
	}
	.table>tbody>tr>td, .table>tfoot>tr>td, .table>tfoot>tr>th{
		border-top: 1px solid rgb(2, 143, 208);
	}
	td img{
		width: 37px;
		height: 35px;
		/* border-radius: 50%; */
	}
	td input{
		width: 30%;
	}
	a:hover{
		cursor: pointer;
	}
	#searchByCustomerName{
		width: 50px;
	}
	#searchByGoodsName{
		width: 50px;
	}
	#updateQuotePrice{
		position: absolute;
		top: 55px;
	}
	
	/* 分页样式 */
	#page{
		width: 100%;
		display: flex;
		justify-content: flex-end;
	}
</style>
</head>
	<body>
		<div class="row elDocument"style="padding: 28px 20px;">
                    <!-- column -->
                    <div class="col-lg-12">
                        <div class="card">
                            <div class="card-block">
                            	 <h5 class="card-subtitle " style="float: right;width: 60%;display: flex;flex-direction: row;justify-content: space-around;">
                            	 	<div class="input-group" style="margin-right: 10%;">
										<input id="customerName" type="text" value="" class="form-control" placeholder="客户名称">
										<span class="input-group-btn"><button id="searchByCustomerName" type="button" class="btn btn-primary">Go</button></span>
									</div>
                            	 	<div class="input-group" style="margin-right: 10%;">
										<input id="goodsName" type="text" value="" class="form-control" placeholder="商品名称">
										<span class="input-group-btn"><button id="searchByGoodsName" type="button" class="btn btn-primary">Go</button></span>
									</div>
                                	<input type="button" class="btn btn-primary" id="add" value="新增客户报价"/>
                                	<input type="hidden" id="uid" value=""/>
                                </h5>
                                <h4 class="card-title">客户报价</h4>
                               <form id="quoteForm" action="" method="post"></form>
                                <div class="table-responsive">
                                    <table class="table">
                                        <thead>
                                            <tr>
                                            	<th>商品图片</th>
                                                <th>商品名称</th>
                                                <th>客户名称</th>
                                                <th>客户报价</th>
                                                <th>商品单位</th>
                                                <th>报价时间</th>
                                                <th>修改报价</th>
                                                <th>删除报价</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr v-for="(o,i) in pageIf.list">
                                                <td>
                                                <img v-if="o.gvobj.column1==null" :src="'data:image/png;base64,'+o.gvobj.goods.img"/>
                                                <img v-else :src="o.gvobj.column1"/>
                                                </td>
                                                <td>{{o.gvobj.goods.name}}</td>
                                                <td>{{o.cobj.name}}</td>
                                                <td>{{o.qpobj.price}}</td>
                                                <td>{{o.gobj.bitval}}</td>
                                                <td>{{dada(o.qpobj.time)}}</td>
                                                <input type="hidden" :value="o.qpobj.id" />
                                                <td>
                                                	<input type="hidden" :vul="o.qpobj.price" name="" class="" :value="o.qpobj.price" />
                                                	<input type="hidden" name="" class="" :value="o.qpobj.id" />
                                                	<a class="upd glyphicon glyphicon-edit" data-toggle="modal" data-target="#updateQuotePrice" onclick="toupdate(this)" style="color: rgb(2, 143, 208);"></a>
                                                </td>
                                                <td><a class="del glyphicon glyphicon-trash" style="color: rgb(2, 143, 208);" onclick="qdelete(this)"></a></td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                
                              <div class="modal fade" id="updateQuotePrice" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">		
								<div class="modal-dialog" role="document">
		    						<div class="modal-content">
		      							<div class="modal-header">
									        <!-- <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button> -->
									        <h4 class="modal-title" id="myModalLabel">修改客户报价价格</h4>
		      							</div>
								      	<div class="modal-body">
								      		<form class="form-horizontal" id="updateQuotePriceForm" action="updatequotedprice" method="post">
								      		<input type="hidden" name="qid" class="quoteId" value="" />
										  	<div class="form-group">
										    	<label for="inputEmail3" class="col-sm-3 control-label">报价价格</label>
											    <div class="col-sm-9">
											    	<input type="text" class="form-control quotePrice" value="" disabled="disabled">
											    </div>
										  	</div>
										  	<div class="form-group">
										    	<label for="inputPassword3" class="col-sm-3 control-label">修改报价</label>
											    <div class="col-sm-9">
											      <input type="text" value="" class="form-control updatePrice" name="price">
											    </div>
										  	</div>
										  	
										</form>
								        
								      	</div>
								      <div class="modal-footer">
								        <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
								        <button type="button" class="btn btn-primary" id="update">提交</button>
								      </div>
		    						</div>
		  						</div>
		  				</div>
                                
                                <!-- 分页 -->
                                <div id="page">
                                
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
	</body>
	<script th:src="@{/assets/js/jquery.min.js}"></script>
 	<script th:src="@{/assets/vendor/jquery/jquery.js}"></script>
    <!-- Bootstrap tether Core JavaScript -->
    <script th:src="@{/assets/js/tether.min.js}"></script>
    <script th:src="@{/assets/js/bootstrap.min.js}"></script>
    <!-- slimscrollbar scrollbar JavaScript -->
    <script th:src="@{/assets/js/jquery.slimscroll.js}"></script>
    <!--Wave Effects -->
    <script th:src="@{/assets/js/waves.js}"></script>
    <!--Menu sidebar -->
    <script th:src="@{/assets/js/sidebarmenu.js}"></script>
    <!--stickey kit -->
    <script th:src="@{/assets/js/sticky-kit.min.js}"></script>
    <!--Custom JavaScript -->
    <script th:src="@{/assets/js/custom.min.js}"></script>
    <script th:src="@{/assets/js/vue.js}"></script>
    <script th:src="@{/assets/js/pageNumber.js}"></script>
    
	<script>
	
	var vue=new Vue({
		el:".elDocument",
		data:{
			pageIf:"",
			user:{}
		},
		methods:{
			dada:function(inputTime){
				 var date = new Date(inputTime);
				    var y = date.getFullYear();
				    var m = date.getMonth() + 1;
				    m = m < 10 ? ('0' + m) : m;
				    var d = date.getDate();
				    d = d < 10 ? ('0' + d) : d;
				    var h = date.getHours();
				    h = h < 10 ? ('0' + h) : h;
				    var minute = date.getMinutes();
				    var second = date.getSeconds();
				    minute = minute < 10 ? ('0' + minute) : minute;
				    second = second < 10 ? ('0' + second) : second;
				    return y + '-' + m + '-' + d + ' ' + h + ':' + minute + ':' + second;

			}
		}
	});
	
	/* 去修改报价 */
	function toupdate(th){
		var id=$(th).prev().val();
		var price=$(th).prev().prev().val(); 
		$("#updateQuotePriceForm .quoteId").attr("value",id);
		$("#updateQuotePriceForm .quotePrice").attr("value",price);
		
	}
	
	/* 删除报价 */
	function qdelete(th){
		var id=$(th).parent().prev().prev().val();
		$("#quoteForm").attr("action","deletequote?qid="+id);
		$("#quoteForm").submit();
	}
	
	/* 分页查询 */
	function queryQuoteByPage(curentPage){
		var cname=$("#customerName").val();
		var gname=$("#goodsName").val();
		var uid=$("#uid").val();
		$.ajax({
			url:"queryquoteprice",
			data:{
				"cname":cname,
				"gname":gname,
				"uid":uid,
				"curentPage":curentPage
			},
			type:"post",
			dataType:"json",
			success:function(result){
				vue.pageIf = result;
				$("#page").append(
						page(vue.pageIf.pageNum, vue.pageIf.prePage,
								vue.pageIf.nextPage, vue.pageIf.pages));
			}
		});
	}
	
	
	
		$(function() {
			vue.user = JSON.parse(window.localStorage.getItem("user"));
			$("#uid").val(vue.user.id);
			
			queryQuoteByPage(1);
			/* 分页点击 */
			$(document).on(
					"click",
					".pageFy>ul li",
					function() {
						var create = $(this).attr("pageNumber");
						if (create != null && create != 0) {
							queryQuoteByPage(create); 
						}
					});
			
			$("#searchByCustomerName").click(function(){
				queryQuoteByPage(1);
			});
			
			$("#searchByGoodsName").click(function(){
				queryQuoteByPage(1);
			});
			
			/*新增客户报价*/
			$("#add").click(function(){
				$("#quoteForm").attr("action","toaddquote");
				$("#quoteForm").submit();
			});
			
			/* 修改客户报价 */
			$("#update").click(function(){
				var price=$("#updateQuotePriceForm .updatePrice").val();
				if(price==""){
					alert("报价不能为空！");
				}else{
					$("#updateQuotePriceForm").attr("action","updatequotedprice");
					$("#updateQuotePriceForm").submit();
				} 
			});
	
		});
	</script>
</html>
