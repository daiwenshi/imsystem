<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>添加订单</title>
<link rel="stylesheet" th:href="@{/assets/css/bootstrap.min.css}">
<link rel="stylesheet" th:href="@{/assets/css/toastr.css}">
<script type="text/javascript"
	th:src="@{/assets/js/jquery-2.1.4.min.js}"></script>
<script type="text/javascript" th:src="@{/assets/js/bootstrap.min.js}"></script>
<script type="text/javascript" th:src="@{/assets/js/vue.js}"></script>
<script type="text/javascript" th:src="@{/assets/js/toastr.min.js}"></script>
<script type="text/javascript" th:src="@{/assets/js/klorofil-common.js}"></script>
<style type="text/css">
body, html, #main {
	max-height: 100%;
	height: 100%;
	margin: 0px;
}

ul {
	list-style: none;
}

#main {
	display: flex;
}

.table-page-left {
	max-width: 28%;
	width: 28%;
	border-right: 1px solid rgb(2, 143, 208);
	padding: 10px;
	-webkit-user-select: none;
}

.table-page-right {
	width: 72%;
	padding: 10px;
	background: #f7f7f7;
	overflow-y: auto;
	-webkit-user-select: none;
}

.table-options {
	display: flex;
	text-align: center;
	font-size: 16px;
	color: #584d4d;
	height: 6%;
}

.table-option {
	width: 50%;
	height: 300;
	line-height: 30px;
	cursor: pointer;
}

.table-option-action {
	color: dodgerblue;
	border-bottom: 1px solid rgb(2, 143, 208);
}

.table-div-bottom {
	position: absolute;
	right: 0px;
	bottom: 0px;
}

.table-divs {
	max-height: 94%;
	height: 94%;
	position: relative;
	display: flex;
	overflow: hidden;
}

.table-div {
	position: absolute;
	height: 100%;
	width: 100%;
}

.table-div:last-child {
	right: 103%;
}

button {
	background: rgb(2, 143, 208);
	padding: 5px 10px;
	color: white;
	border: 1px solid #ddd;
	border-radius: 3px;
	font-size: 13px;
	outline: none;
	cursor: pointer;
}

.table-div>ul>li>div {
	display: flex;
	justify-content: space-around;
	line-height: 40px;
	border-bottom: 1px solid rgb(2, 143, 208);
	font-size: 12px;
	color: rgb(2, 143, 208);
	position: relative;
	cursor: pointer;
}

.table-div>ul>li:first-child {
	color: rgb(2, 143, 208);
	font-size: 15px;
}

.table-div>ul {
	padding: 10px 0px;
	margin: 0px;
	height: 100%;
}

.del-ul-li {
	cursor: pointer;
}

.table-div>ul>li>div>div {
	width: 100%;
	text-align: center;
	overflow: hidden;
	white-space: nowrap;
	text-overflow: ellipsis;
}

.table-div-ul-ul {
	display: none;
	position: relative;
}

.table-div-ul-ul>li {
	display: flex;
	line-height: 30px;
	font-size: 12px;
	color: #ef6560;
	position: relative;
	border-bottom: 1px solid #bcde87;
	white-space: nowrap;
	text-overflow: ellipsis;
}

.table-div-ul-ul>li>div {
	width: 100%;
	overflow: hidden;
	white-space: nowrap;
	text-overflow: ellipsis;
	text-align: center;
	text-overflow: ellipsis;
}

.table-div-SumPrice {
	position: absolute;
	left: 0px;
	bottom: 0px;
	font-size: 15px;
}

#right-head {
	display: flex;
}

.right-head-div-options {
	width: 100px;
	line-height: 35px;
	background: rgb(2, 143, 208);
	text-align: center;
	color: white;
	cursor: pointer;
}

#right-head>div:first-child {
	border-radius: 8px 0px 0px 8px;
	border-right: 1px solid white;
}

#right-head>div:nth-child(2) {
	border-radius: 0px 8px 8px 0px;
}

.right-head-div-active {
	background: red;
}

#goodsAll, #custmoer {
	display: flex;
	flex-wrap: wrap;
	padding-top: 80px;
}

.goods>div {
	cursor: pointer;
	width: 100%;
	background: white;
	height: 100%;
	transition: all 0.5s;
}

.goods>div>div {
	max-width: 50%;
	margin: 8px auto;
}

.goods {
	width: 33%;
	height: 350px;
	padding: 5px;
	margin-bottom: 8px;
	text-align: center;
}

.goods>div:hover {
	transform: translate3d(0, -2px, 0);
	box-shadow: 0 15px 30px rgba(0, 0, 0, .1);
}

.images {
	width: 70px;
	margin: auto;
	position: relative;
	top: 30px;
}

.images>img {
	width: 100%;
}

.goodsName {
	font-size: 20px;
	font-weight: 500;
	overflow: hidden;
	white-space: nowrap;
	text-overflow: ellipsis;
}

.goodsPrice {
	margin-top: 10px;
	color: rgb(2, 143, 208);
}

.goodsType {
	font-size: 16px;
	color: rgb(2, 143, 208);
	overflow: hidden;
	white-space: nowrap;
	text-overflow: ellipsis;
}

.count>input {
	width: 60px;
	border: none;
	border-bottom: 1px solid #ddd;
	text-align: center;
	outline: none;
}

.count>span {
	font-size: 16px;
}

.fileHead {
	position: fixed;
	top: 0px;
	padding: 10px;
	width: 100%;
	z-index: 9;
	background: #f7f7f7;
	height: 60px;
}

.selectDiv {
	margin-left: 20px;
	display: flex;
}

.selectDiv>div {
	line-height: 35px;
	padding: 0px 10px;
	background: #188dea;
	color: white;
	border-radius: 8px 0px 0px 8px;
}

.selectDiv>input {
	outline: none;
	border-color: #188dea;
	border-radius: 0px 8px 8px 0px;
	text-indent: 2em;
	width: 240px;
}

.goodsNumber {
	height: 30px;
	outline: none;
	text-align: center;
	width: 60px;
	border: 0;
}

.zhebiceng {
	width: 100%;
	height: 100%;
	background-color: rgba(181, 173, 173, 0.5);
}

.tanchu, .discounts {
	position: fixed;
	width: 100%;
	height: 100%;
	z-index: 999;
	color: rgb(2, 143, 208);
	display: none;
}

.tanbody {
	position: absolute;
	width: 60%;
	top: 50%;
	height: 60%;
	background: white;
	border: 1px solid #03A9F4;
	transform: translate(-50%, -50%);
	left: 50%;
	border-radius: 1%;
	padding: 10px 20px;
	overflow-y: auto;
}

.zhebicengDivs {
	display: flex;
	height: 50px;
	width: 100%;
	line-height: 50px;
	margin-top: 30px;
}

.zhebicengDivs>div {
	border: 1px solid rgb(2, 143, 208);
	background: rgb(2, 143, 208);
	color: white;
	padding: 0px 10px;
	border-radius: 3px 0 0 3px;
	font-size: 16px;
}

.zhebicengDivs>input {
	border: 1px solid rgb(2, 143, 208);
	width: 83%;
	text-indent: 1em;
	font-size: 20px;
	outline: none;
	border-radius: 0 3px 3px 0;
}

.zhebuttom {
	margin-top: 20px;
}

.zhebuttom>div {
	width: 90px;
	height: 45px;
	line-height: 45px;
	text-align: center;
	color: white;
	background: red;
	float: right;
	margin-right: 20px;
	border-radius: 7px;
	font-size: 17px;
	cursor: pointer;
}

#toast-container>div {
	opacity: 1;
}

.paytype, .clientList {
	width: 180px;
	height: 45px;
	text-indent: 1em;
	border: 1px solid rgb(2, 143, 208);
	font-size: 16px;
}
.table-page-right::-webkit-scrollbar {
	width: 3px;
	height: 2px;
	background: #ccc;
	border-radius: 10px; 
}

.table-page-right::-webkit-scrollbar-thumb {
	width: 2px;
	border-radius: 10px;
	background: #0089dc; 
}
.tanbody::-webkit-scrollbar {
	width: 3px;
	height: 2px;
	background: #ccc;
	border-radius: 10px; 
}

.tanbody::-webkit-scrollbar-thumb {
	width: 2px;
	border-radius: 10px;
	background: #0089dc; 
}

.discountsDiv {
	height: 70px;
	width: 100%;
	border: 1px solid rgb(2, 143, 208);
	margin-top: 20px;
	border-radius: 7px;
}

.colsediscountsDivs{
	position: absolute;
	right: 5px;
	top: 5px;
	cursor: pointer;
}
.discountsDivactive{
	border: 1px solid #ec3e22;
}
</style>
</head>
<body>
	<div id="main">
		<div class="discounts" style="display:none">
			<div class="zhebiceng"></div>
			<div class="tanbody discountsDivs">
				<span class="glyphicon glyphicon-remove-circle colsediscountsDivs" @click="colsediscountsDivs"></span>
				<div class="discountsDiv">
					
				</div>
			</div>
		</div>
		<div class="tanchu">
			<div class="zhebiceng"></div>
			<div class="tanbody">
				<div class="zhebicengDivs">
					<div>未折金额</div>
					<input type="text" v-model="tanchuwprice">
				</div>
				<div class="zhebicengDivs">
					<div style="background-color: #f3a03a; border: 1px solid #f3a03a;">应付金额</div>
					<input type="text" style="border: 1px solid #f3a03a;"
						v-model="tanchuyprice">
				</div>
				<div class="zhebicengDivs">
					<div style="background-color: #ec3e22; border: 1px solid #ec3e22;">实付金额</div>
					<input type="text" style="border: 1px solid #ec3e22;"
						v-model="tanchusprice">
				</div>
				<div class="zhebuttom">
					<select class="clientList" disabled>
						<option v-for="item in clientlist" :value="item.id">{{item.name}}</option>
					</select> <select class="paytype">
						<option v-for="item in paytype" :value="item.id">{{item.name}}</option>
					</select>
					<div style="background-color: rgb(2, 143, 208)"
						@click="tanchushow(0)">确定</div>
					<div style="background-color: #f3a03a" @click="tanchushow(1)">取消</div>
				</div>
			</div>
		</div>
		<div class="table-page-left">
			<div class="table-options">
				<div class="table-option table-option-action">
					<span>订单</span>
				</div>
				<div class="table-option">
					<span>挂单</span>
				</div>
			</div>
			<div class="table-divs">
				<div class="table-div">
					<ul class="order-goods">
						<li class="head-title">
							<div>
								<div>商品名称</div>
								<div>数量</div>
								<div>单价</div>
								<div>总计</div>
							</div>
						</li>
						<li style="height: 85%; overflow-y: auto; overflow-x: hidden;">
							<div v-for="(item,index) in orderShapping" v-if="item != null"
								:index="index">
								<div>{{item.goods.name}}</div>
								<div>
									<input class="goodsNumber" type="text"
										@input="input(item.goods.column1,index)"
										v-model="item.goods.column1">
								</div>
								<div>{{item.goods.price}}</div>
								<div>{{item.goods.column1 * item.goods.price}}</div>
							</div>
						</li>
					</ul>
					<div class="table-div-bottom">
						<button @click="upOrder">挂单</button>
						<button @click="inserAddOk">确认订单</button>
					</div>
					<div class="table-div-SumPrice">
						<span>总和：</span><span style="color: red;">￥<span
							style="font-size: 20px;">{{sum.toFixed(2)}}</span></span>
					</div>
				</div>
				<div class="table-div">
					<ul class="table-div-ul">
						<li>
							<div>
								<div>客户名称</div>
								<div>数量</div>
								<div>价格</div>
								<div>操作</div>
							</div>
						</li>
						<li v-for="(item,index) in upOrderList" v-if="item != null">
							<div @click="upDown($event)">
								<div>
									<span>{{item.order.client.name}}</span>
								</div>
								<div>
									<span>{{item.order.count}}</span>
								</div>
								<div>
									<span>{{item.order.sum}}</span>
								</div>
								<div>
									<span title="确认订单" @click="order_ok(index)" class="order-ok">√</span>&nbsp;&nbsp;&nbsp;&nbsp;<span
										title="取消" @click="upOrderListDel(index,$event)"
										class="del-table-ul-li">></span>
								</div>
							</div>
							<ul class="table-div-ul-ul" style="padding-left: 20px;">
								<li v-for="(item1,index1) in item.list" v-if="item1 != null">
									<div>
										<span>{{item1.goods.name}}</span>
									</div>
									<div>
										<span>{{item1.goods.column1}}</span>
									</div>
									<div>
										<span>{{item1.goods.price}}</span>
									</div>
									<div>
										<span>{{item1.goodsValue.name}}</span>
									</div>
									<div class="del-ul-li"
										@click="upOrderListListDel(index,index1,$event)">></div>
								</li>
							</ul>
						</li>
					</ul>
				</div>
			</div>
		</div>
		<div class="table-page-right">
			<div class="fileHead">
				<div id="right-head">
					<div class="right-head-div-options">客户</div>
					<div class="right-head-div-options right-head-div-active">商品</div>
					<div class="selectDiv" style="display: none">
						<div>客户名称</div>
						<input type="text" @keyup.enter="clientkeycode"
							v-model="clientNames">
					</div>
					<div class="selectDiv">
						<div>商品名称</div>
						<input type="text" @keyup.enter="goodskeycode" v-model="goodsName">
					</div>
					<div class="selectDiv">
						<div style="border-radius: 7px; cursor: pointer;" @click="opendiscounts" >选择活动</div>
					</div>
				</div>
			</div>
			<div id="custmoer" class="right-head-click" style="display: none;">
				<div class="goods" v-for="(item,index) in clientlist">
					<div style="position: relative;">
						<div class="images">
							<img th:src="@{/assets/img/qq.png}" />
						</div>
						<div class="goodsName" :title="item.name"
							style="margin-top: 50px;">
							<span>{{item.name}}</span>
						</div>
						<div class="goodsType" style="font-size: 24px; color: red;">
							<span>{{item.column1}}</span>
						</div>
						<div class="goodsName"
							style="font-size: 18px; color: rgb(2, 143, 208);">
							<span>{{item.telephone}}</span>
						</div>
						<div style="margin-top: 30px;">
							<button @click="clientPrice(index)">确定</button>
						</div>
					</div>
				</div>
			</div>
			<div id="goodsAll" class="right-head-click">
				<div v-for="(item,index) in list" class="goods">
					<div>
						<div class="images">
							<!-- <img v-if="item.goodsValue.column1 != null && item.goodsValue.column1 != ''" :src="item.goodsValue.column1" />
							<img v-else :src="item.goods.img" /> -->
							<img :src="'data:image/png;base64,'+item.goods.img" />
						</div>
						<div class="goodsName" style="margin-top: 50px;">
							<span>{{item.goods.name}}</span>
						</div>
						<div class="goodsType">
							<span>{{item.goodsValue.name}}</span>
						</div>
						<div class="goodsPrice">
							<span style="color: red; font-size: 20px;">￥<span>{{item.goods.price}}</span></span>
						</div>
						<div class="count">
							<span>+</span>&nbsp;&nbsp;<input type="text" value="1" />&nbsp;&nbsp;<span>-</span>
						</div>
						<div class="goodsOk">
							<button v-on:click="addOrderShapping(index,$event)">新增</button>
						</div>
					</div>
				</div>
			</div>
		</div>
		<script type="text/javascript" th:inline="javascript">
		
		var vue = new Vue({
			
			el : "#main",
			
			data : {
				
				list : [],
				
				goodsName : "",
				
				clientlist : [],
				
				paytype : [],
				
				clientNames : "",
				
				user : JSON.parse(localStorage.getItem("user")),
				
				orderShapping : [],
				
				sum : 0,
				
				tanchuwprice : 0,
				
				tanchuyprice : 0,
				
				tanchusprice : 0,
				
				clientName : {
					id : 0,
					name : "零售客户"
				},
				
				count : 0,
				
				index : 0,
				
				boolOk : true,
				
				upOrderList : localStorage.getItem("upOrderList") == null ? [] : JSON.parse(localStorage.getItem("upOrderList"))
				
			},
			methods : {
				localStorage : function(){
					
					localStorage.setItem("upOrderList",JSON.stringify(vue.upOrderList));
				},
				order_ok : function (index){
					
					$(".clientList").val(this.upOrderList[index].order.client.id);
					
					this.index = index;
					
					this.tanchuwprice = this.upOrderList[index].order.wsum;
					this.tanchuyprice = this.upOrderList[index].order.sum;
					this.tanchusprice = this.upOrderList[index].order.sum;
					
					this.count =  this.upOrderList[index].order.count;
					
					$(".tanchu").show();
					
				},
				inserAddOk : function(){
					
					this.boolOk = false;
					
					this.tanchuwprice = 0;
					this.tanchuyprice = 0;
					this.tanchujprice = 0;
					
					this.orderShapping.forEach(item => {
						
						if(item){
							
							this.tanchuwprice += item.goods.jprice * item.goods.column1;
							this.tanchuyprice += item.goods.price * item.goods.column1;
							this.tanchusprice += item.goods.price * item.goods.column1;
							
						}
						
					});
					
					$(".tanchu").show();
					
				},
				opendiscounts : function (){
					$.ajax({
					    
					    url : [[@{/}]],

					    data : JSON.stringify(this.orderShapping),

					    type : "post",

					    dataType : "json",
					    
					    contentType : "application/json; charset=UTF-8",	
					    
					    processData: false,
					    
					    success:function(result){
							
					    }
					})
					$(".discounts").show();
					
				},
				colsediscountsDivs : function (){
					$(".discounts").hide();
				},
				tanchushow : function (index){
					if(index == 0){
						
						var sales = {
								price : this.tanchuwprice,
								paymoney : this.tanchuyprice,
								tainmoney : this.tanchusprice,
								uid : this.user.id,
								storeid : this.user.storeid,
								state : 0,
								paytype : $(".paytype").val(),
								cid : $(".clientList").val(),
								count : this.count,
								list : []
						};
						if(this.boolOk){
							this.upOrderList[this.index].list.forEach(item => {
								
								if(item){
									var salesdetails = {
										gvid : item.goodsValue.id,
										price : item.goods.price,
										oldprice : item.goods.jprice,
										count : item.goods.column1,
										state : 0
									}
									sales.list.push(salesdetails)
								}
							}); 
						}
						else{
							
							this.orderShapping.forEach(item => {
								
								if(item){
									var salesdetails = {
										gvid : item.goodsValue.id,
										price : item.goods.price,
										oldprice : item.goods.jprice,
										count : item.goods.column1,
										state : 0
									}
									sales.list.push(salesdetails)
								}
								
							});
						}
						
						$.ajax({
						    
						    url : [[@{/insertOrder/insertsalesAddOrder}]],

						    data : JSON.stringify(sales),

						    type : "post",

						    dataType : "json",
						    
						    contentType : "application/json; charset=UTF-8",							
						   
						    processData: false,
						    
						    success:function(result){
								if(result){
									
									alerts("订单确认成功")
									
									if(vue.boolOk){
										vue.upOrderList.splice(vue.index,1,null);
										vue.$options.methods.localStorage();
									}
									else{
										vue.orderShapping = [];
									}
									
									vue.clientName = {
											id : 0,
											name : "零售客户"
									}
									
									setTimeout(() => {
										alerts("已切换至:零售客户")
									});
									
								}else{
									
									alerts("库存不足")
								}
								
						    } 
						});
						
					}
					$(".tanchu").hide();
				},
				clientPrice : function (index){
					
					this.clientName = this.clientlist[index];
					
					alerts("转换操作用户："+this.clientName.name);
					
					$(".clientList").val(this.clientName.id);
					
					this.orderShapping[0].goods.column4 = this.clientName.id;
					
					$.ajax({
					    
					    url : [[@{/orderQueryController/foreachshappingPriceOrderAdd}]],

					    data : JSON.stringify(this.orderShapping),

					    type : "post",

					    dataType : "json",
					    
					    contentType : "application/json; charset=UTF-8",		
					    
					    processData: false,
					    
					    success:function(result){
					    	
					    	this.orderShapping = result;
					    	
					    }
					});
					
				},
				upOrderListListDel : function (index,index1,obj){
					
					let current = obj.currentTarget;
					
					var th = $(current).parent();
					
					let len = 0;
					
					th.animate({
						
						"left" : "100%",
						"opacity" : "0"
						
					}, 1000,function (){
						
						vue.upOrderList[index].list.forEach(item => {
							if(item)
								len++;
						})
						
						if(len == 1){
							
							vue.upOrderList.splice(index,1,null);
							
							vue.$options.methods.localStorage();
							
							return;
								
						}
						
						vue.upOrderList[index].order.count -= vue.upOrderList[index].list[index1].goods.column1;
						
						vue.upOrderList[index].order.sum -= vue.upOrderList[index].list[index1].goods.column1 * vue.upOrderList[index].list[index1].goods.price;
						
						vue.upOrderList[index].order.wsum -= vue.upOrderList[index].list[index1].goods.column1 * vue.upOrderList[index].list[index1].goods.jprice;
						
						vue.upOrderList[index].list.splice(index1,1,null);
						
						vue.$options.methods.localStorage();
						
					});
					
				},
				upOrderListDel : function (index,obj){
					
					let current = obj.currentTarget;
					
					var th = $(current).parent().parent();

					th.animate({
						
						"left" : "100%",
						"opacity" : "0"
						
					}, 1000);
					th.next().animate({
						
						"left" : "100%",
						"opacity" : "0"
						
					}, 1000, function() {
						
						vue.upOrderList.splice(index,1,null);
						
						let s = 0;
						
						vue.upOrderList.forEach(item => {
							if(item){
								s++;
							}
						});
						
						if(!s){
							vue.upOrderList = [];
						}
						
						vue.$options.methods.localStorage();
					});
					
				},
				upOrder : function (){
					
					var date = new Date();
					var upOrder = {
							order : null,
							
							list : null
							
					}
					var order = {
							
						client : vue.clientName,
						
						count : 0,
						
						sum : 0,
						
						wsum : 0
							
					};
					
					this.orderShapping.forEach((item,i) => {
						
						if(item){
							
							order.count += item.goods.column1;
							
							order.sum += item.goods.column1*item.goods.price;
							
							order.wsum += item.goods.column1*item.goods.jprice;
						}
						
					});
					
					upOrder.order = order;
					
					upOrder.list = JSON.parse(JSON.stringify(this.orderShapping));
					
					this.upOrderList.push(upOrder);
					
					this.orderShapping = [];
					
					this.sum = 0;
					
					vue.$options.methods.localStorage();
					
					vue.clientName = {
							id : 0,
							name : "零售客户"
					}
					
					alerts("已切换至:零售客户")
					
				},
				addOrderShapping : function (index,obj){
					
					let current = obj.currentTarget;
					
					let count = parseInt($(current).parent().prev().find("input").val());
					try{
						this.orderShapping.forEach((item,i) => {
							if(item){
								if(item.goodsValue.id == this.list[index].goodsValue.id){
									
									this.sum -= item.goods.column1 * item.goods.price;
									
									this.list[index].goods.column1 = parseInt(this.list[index].goods.column1) + count;
									
									item.goods.column1 = this.list[index].goods.column1;
									
									this.sum += item.goods.column1 * item.goods.price;
									
									throw new Error("StopIteration");
								} 
							}
							
						});
						
						this.list[index].goods.jprice = this.list[index].goods.price;
						
						this.list[index].goods.column1 = count;
						
						this.sum += this.list[index].goods.column1 * this.list[index].goods.price;
						
						this.orderShapping.push(this.list[index]);
						
						vue.$options.methods.clientPrice();
						
						setTimeout(() => {
							
							down($(".order-goods>li>div"));
							
						},200);
						
					}
					catch(e){
						
					}
				},
				upDown : function (obj){
					
					let current = obj.currentTarget;
					
					if ($(current).next().hasClass("table-div-ul-ul")) {
						if ($(current).next().css("display") == "none") {
							
							$(current).next().slideDown();
							
						} else {
							
							$(current).next().slideUp();
						}
					}
					
				},
				input : function (val,index){
					
					this.list[index].goods.column1 = val;
					
					sum()
					
				},
				goodskeycode : function(){
					
					$.ajax({
					    
					    url : [[@{/orderQueryController/orderAddAjax}]],

					    data : {
							name : this.goodsName
					    },

					    type : "post",

					    dataType : "json",
					    
					    success:function(result){
					    	
							vue.list = result;
					    
					    }
					});
				},
				
				clientkeycode : function(){
					$.ajax({
					    
					    url : [[@{/orderQueryController/clientAjax}]],

					    data : {
						 	name : this.clientNames,
						 	storeid : "1"
					    },

					    type : "post",

					    dataType : "json",
					    
					    success:function(result){
					    	vue.clientlist = result;
					    }
					})
				}
				
			}
		});
		
		vue.list = [[${list}]];
		
		vue.clientlist = [[${clientList}]];
		
		vue.paytype = [[${paytype}]];
		
		$(function() {
			$(".table-option").click(function() {

				$(".table-div").stop().animate();

				$(".table-option").removeClass("table-option-action");
				$(this).addClass("table-option-action");
				var index = $(".table-option").index(this);

				if (index == 1) {
					$(".table-div:eq(0)").animate({
						"left" : "103%"
					}, 500);
					$(".table-div:eq(1)").animate({
						"right" : "0"
					}, 500);
				} else {
					$(".table-div:eq(1)").animate({
						"right" : "103%"
					}, 500);
					$(".table-div:eq(0)").animate({
						"left" : "0"
					}, 500);
				}
			});
			
			$(".right-head-div-options").click(
					function() {
						$("#right-head>div").removeClass(
								"right-head-div-active");
						$(this).addClass("right-head-div-active");

						let index = $("#right-head>div").index(this);
						$(".right-head-click:eq(" + index + ")").css("display",
								"flex");
						$(".selectDiv:eq("+index+")").css("display","flex");
						if (index == 1) {
							
							index--;
							
						} else {
							
							index++;
							
						}
						$(".selectDiv:eq("+index+")").css("display","none");
						$(".right-head-click:eq(" + (index) + ")").css(
								"display", "none");
					});
		});
		
		function sum(){
			vue.sum = 0;
			vue.orderShapping.forEach((item,i) => {
				if(item){
					vue.sum += item.goods.column1 * item.goods.price;	
				}
				
			});
		}

		//绑定华东事件
		var down = function(objs) {

			objs.each(function(i, obj) {
				if (!$(obj).hasClass("head-title")) {
					$(obj).bind("mousedown", strat);

					var left = 0;

					function strat(even) {
						if (event.button == 0) {
							left = even.clientX;
							$(document).bind("mousemove", move);
							$(document).bind("mouseup", stop);
						}
					}

					function move(even) {
						$(obj).css({
							left : even.clientX - left + "px"
						});
					}

					function stop(even) {
						$(document).unbind("mousemove", move);
						$(document).unbind("mouseup", stop);
						//解绑定，这一步很必要，前面有解释 
						if (even.clientX - left > 100) {
							$(obj).animate({
								"opacity" : "0"
							}, 300, function() {
								
								var index = $(obj).attr("index");
								
								vue.orderShapping.splice(index,1,null);
								
								sum();
								
							});
						} else {
							$(obj).css("left", "0")
						}
					}
				}

			})

		}
		function alerts(str){
			
			toastr.options.timeOut = "true"
			
			toastr.options.closeButton = true;
			
			toastr['info']
					(str);
			
			$positionClass = 'toast-top-center';
			
			toastr.remove();
			
			$context="info";
			
			toastr[$context](str, '', {
				
				positionClass : $positionClass
				
			});
			
			setTimeout(function(){
				$("#toast-container").fadeOut(1000);
			},4000)
		}
	</script>
	</div>
</body>
</html>